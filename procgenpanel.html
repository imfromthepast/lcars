<html>
    <head>            
        <script type="text/javascript" src="https://code.createjs.com/easeljs-0.8.2.min.js"></script>
        <script type="text/javascript" src="https://code.createjs.com/tweenjs-0.6.2.min.js"></script>
        <script type="text/javascript" src="src/js/isjs.js"></script>
        <script src="https://code.createjs.com/1.0.0/soundjs.min.js"></script>
        <!-- <script type="text/javascript" src="src/js/soundjs.min.js"></script> -->
        <link rel="stylesheet" href="src/lcars.css"></link>
        <style>
            body{
                color:#fff;
                font-family: Okuda, sans-serif;
            }
        </style>
    </head>
    <body onload="loadSounds();">
        <h1>LCARS UI (randomized)</h1>
        <canvas id="ran"></canvas> 
    </body>
    
    <script type="text/javascript" src="src/js/lcars.js"></script>
    <script>  
        const panelWidths=[2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000];
        const panelHeights=[600,650,700,750,1000];
        const sectionWidths=[150,200,300,400];
        const sectionMiddleWidths=[50,100,100,100,100,200,200,200,200,200,300,300,300,300,300,300,300,400,400,400,400,400];
        const buttonTypes=['pill','rect','pill-right','pill-left'];
        const sectionTransitionTable = {
            0:[1,2,3,4],
            1:[0,1,2,3,4],
            2:[0,2,3],
            3:[0,1,2],
            4:[0,1,2,3]
        }
        getNextSection = function(currentSection,ran){
            var transitionArray = sectionTransitionTable[currentSection];
            var p = ran % transitionArray.length;
            return transitionArray[p];
        }
        const sectionOpts=[
            {width:50,text:'ge 0'},
            {width:100,text:'ge 1'},
            {width:200,text:'ge 2'},
            {width:300,text:'ge 3'},
            {width:400,text:'ge 4'}
        ];
        const sectionMetadatas={
            '50':[
                {type:'readout'}
            ],
            '100':[
                {type:'buttons',cols:1},
                {type:'readout'}
            ],
            '200':[
                {type:'buttons',cols:1},
                {type:'readout'}
            ],
            '300':[
                {type:'joystick'},
                {type:'buttons',cols:2},
                {type:'readout'}
            ],
            '400':[
                {type:'joystick'},
                {type:'buttons',cols:3},
                {type:'readout'}
            ]
        }
        const sectionLabelsA=['warp','power','helm','power','phaser','lcars','mode','weapons','2we','sdf','goe','',''];
        const sectionLabelsB=['system','management','select','control','status','','','ss4','jb2'];
        let w = rae(panelWidths);
        let h = rae(panelHeights);
        let ran = new LCARS_Panel({width:w,height:h,id:'ran'});
        console.log('panel width',w);
        let panelSectionWidths = [];
        while (w > 0){
            let sw = 0;
            if(ran.width==w)
                sw = rae(sectionWidths);
            else
                sw = rae(sectionMiddleWidths);
            if((w/2)>sw){
                if(w>sw)
                    panelSectionWidths.push(sw);
                else if(w>0)
                    panelSectionWidths.push(w)
            }else{
                sw=w;
                //panelSectionWidths.push(sw);
            }
            console.log(w+'-'+sw+'='+(w-sw));
            w = w-sw;
        }
        for(let i=0;i<panelSectionWidths.length;i++){
            let width = panelSectionWidths[i];
            let radius =[0,0,0,0];
            let text = '';
            if(i==0) radius=[20,0,0,20];
            if(i==panelSectionWidths.length-1) radius=[0,20,20,0];
            if(width>=200) text = rae(sectionLabelsA)+' '+rae(sectionLabelsB);
            let header = new LCARS_Header({radius:radius,text:text,margin:[0,20,100,0]});
            if(panelSectionWidths[i+1]){
                if(panelSectionWidths[i+1]<100)
                    header = new LCARS_Elbow({dir:'left',size:'md',height:240,margin:[0,20,-20,0]})
            }
            let body=[new LCARS_Subheader({height:30})];
            let bodyEl=rae(sectionMetadatas[panelSectionWidths[i]]);
            console.log(bodyEl);
            if(bodyEl.type=='joystick'){
                body.push(new LCARS_Joystick({y:50}))
            }
            if(bodyEl.type=='buttons'){
                let cols = [];
                for(let bi=0;bi<bodyEl.cols;bi++){
                    cols.push(rae(buttonTypes));
                }
                let rows;
                switch(h){
                    case 600: rows=4;
                    break;
                    case 650: rows=5;
                    break;
                    case 700: rows=6;
                    break;
                    case 750: rows=7;
                    break;
                    default: rows=8;
                }
                body.push(new LCARS_ButtonGroups({y:50,cols:cols,rows:rows}))
            }
            ran.sections.push(new LCARS_Section({
                width:width,
                header:header,
                body:body,
                footer:new LCARS_Footer({height:15})
            }));
        }
        ran.build();
    </script>
</html>